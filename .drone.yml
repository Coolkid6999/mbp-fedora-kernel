---
kind: pipeline
name: mbp-fedora-kernel

steps:
- name: build
  image: fedora:31
  pull: always
  volumes:
    - name: build-artifacts
      path: /tmp/artifacts
  commands:
    - ./build.sh

- name: publish-github
  image: plugins/github-release
  volumes:
    - name: build-artifacts
      path: /tmp/artifacts
  settings:
    api_key:
      from_secret: github_token
    files: /tmp/artifacts/*
    prerelease: yes
  when:
    event: tag

volumes:
- name: build-artifacts
  temp: {}
